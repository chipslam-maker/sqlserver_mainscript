using System.Text.RegularExpressions;
using System.Xml;

public string CleanXmlString(string xmlInput)
{
    if (string.IsNullOrEmpty(xmlInput)) return xmlInput;

    // 移除 XML 1.0 不允許的控制字元 (如 \x00 - \x08, \x0B - \x0C, \x0E - \x1F)
    // 這些字元通常是導致 "font / character not found" 或 "invalid character" 的元兇
    return Regex.Replace(xmlInput, @"[\x00-\x08\x0B\x0C\x0E-\x1F]", "");
}

// 使用範例
public void ProcessDataFromDb(string dbColumnValue)
{
    string cleanXml = CleanXmlString(dbColumnValue);
    XmlDocument doc = new XmlDocument();
    try 
    {
        doc.LoadXml(cleanXml);
    }
    catch (XmlException ex)
    {
        // 處理仍然無法解析的情況
    }
}
